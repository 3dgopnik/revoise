# Revoice ‚Äî TTS/STT Pipeline –∏ UI

> –ú–∏–Ω–∏-–ø–∞–π–ø–ª–∞–π–Ω: –∏–∑–≤–ª–µ—á—å –∞—É–¥–∏–æ ‚Üí faster-whisper ‚Üí –ø—Ä–∞–≤–∫–∞ ‚Üí TTS ‚Üí ffmpeg-mux.
> –¶–µ–ª—å ‚Äî ¬´—É—Å—Ç–∞–Ω–æ–≤–∏–ª –∏ –∑–∞–ø—É—Å—Ç–∏–ª¬ª: UI –Ω–∞ PySide6, –æ—Ñ–ª–∞–π–Ω TTS –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, Live-—Ä–µ–∂–∏–º –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.

## üìå –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–°–±–æ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (uv)](#—Å–±–æ—Ä–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è-uv)
2. [–ù–æ–≤–∞—è –æ–±–æ–ª–æ—á–∫–∞ UI (Qt / PySide6)](#–Ω–æ–≤–∞—è-–æ–±–æ–ª–æ—á–∫–∞-ui-qt--pyside6)
3. [–†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞ –∏ —Ç–∞–π–º–∏–Ω–≥–æ–≤](#—Ä–µ–¥–∞–∫—Ç–æ—Ä-—Ç–µ–∫—Å—Ç–∞-–∏-—Ç–∞–π–º–∏–Ω–≥–æ–≤)
4. [TTS-–¥–≤–∏–∂–∫–∏ (–æ—Ñ–ª–∞–π–Ω/–æ–Ω–ª–∞–π–Ω)](#tts-–¥–≤–∏–∂–∫–∏-–æ—Ñ–ª–∞–π–Ω–æ–Ω–ª–∞–π–Ω)
5. [–ó–≤—É–∫: –º—É–∑—ã–∫–∞, SFX, –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å](#–∑–≤—É–∫-–º—É–∑—ã–∫–∞-sfx-–ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å)
6. [–õ—ë–≥–∫–∏–π –≤–∏–¥–µ–æ—Ä–µ–¥–∞–∫—Ç–æ—Ä (—Ç–∞–π–º–ª–∞–π–Ω)](#–ª—ë–≥–∫–∏–π-–≤–∏–¥–µ–æ—Ä–µ–¥–∞–∫—Ç–æ—Ä-—Ç–∞–π–º–ª–∞–π–Ω)
7. [Live —Ä–µ–∂–∏–º (—Ä–µ–∞–ª—Ç–∞–π–º –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç)](#live-—Ä–µ–∂–∏–º-—Ä–µ–∞–ª—Ç–∞–π–º-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç)
8. [¬´–ë—ã–ª–æ ‚Üí —Å—Ç–∞–ª–æ¬ª –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ](#–±—ã–ª–æ--—Å—Ç–∞–ª–æ-–∏-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ)
9. [–ü—Ä–µ—Å–µ—Ç—ã –¥–∏–∫—Ç–æ—Ä–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–∞](#–ø—Ä–µ—Å–µ—Ç—ã-–¥–∏–∫—Ç–æ—Ä–∞-–∏-–∫–∞—á–µ—Å—Ç–≤–∞)
10. [–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –ø–æ —Å–ø—Ä–∏–Ω—Ç–∞–º](#–¥–æ—Ä–æ–∂–Ω–∞—è-–∫–∞—Ä—Ç–∞-–ø–æ-—Å–ø—Ä–∏–Ω—Ç–∞–º)
11. [–†–∏—Å–∫–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞](#—Ä–∏—Å–∫–∏-–∏-–∫–æ–Ω—Ç—Ä–æ–ª—å-–∫–∞—á–µ—Å—Ç–≤–∞)

---

## –°–±–æ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (uv)
- –¢—Ä–µ–±—É–µ—Ç—Å—è Python 3.10‚Äì3.12 –∏ [uv](https://docs.astral.sh/uv/).
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
uv pip install -r requirements.txt
# –∏–ª–∏
uv pip install .
```
- –ó–∞–ø—É—Å–∫ UI:
```bash
uv run python -m ui.main
```
- –ö–∞—Ç–∞–ª–æ–≥ `models/` –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º; —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–µ—Å–∞ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤ `models/model_registry.json`.
- –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ `.venv`,
  –∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–æ–¥–µ–ª–∏ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –≤ `models/` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:
```bash
uv run ruff check .
uv run ruff format --check .
uv run mypy .
uv run pytest -q
```
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–ø–æ—Å–ª–µ –ª–µ–Ω–∏–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏):
```bash
uv run python tools/freeze_reqs.py
```

---

## –ù–æ–≤–∞—è –æ–±–æ–ª–æ—á–∫–∞ UI (Qt / PySide6)
- –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ: –≤—Ö–æ–¥–Ω–æ–µ –≤–∏–¥–µ–æ, –≤—ã–±–æ—Ä TTS, –º—É–∑—ã–∫–∞/SFX, —Ä–µ–Ω–¥–µ—Ä
- –†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞: —Ç–∞–±–ª–∏—Ü–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (start/end/original/edited) + diff-–ø–æ–¥—Å–≤–µ—Ç–∫–∞
- –ê—É–¥–∏–æ–º–∏–∫—Å–µ—Ä: –≥–æ–ª–æ—Å, —Ñ–æ–Ω, SFX
- –•–æ—Ç–∫–µ–∏: Ctrl+O/S/E, Ctrl+Z/Y, Ctrl+C/X/V, Ctrl+A, Ctrl+Enter, Space
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –ü–ö–ú

---

## –†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞ –∏ —Ç–∞–π–º–∏–Ω–≥–æ–≤
- –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç JSON/CSV/SRT, –≤—Å—Ç–∞–≤–∫–∞ –∏–∑ –±—É—Ñ–µ—Ä–∞, —Å–±—Ä–æ—Å –ø—Ä–∞–≤–æ–∫
- –†–∏—Ç–º-—è–∫–æ—Ä—è, –∞–≤—Ç–æ–ø—É–Ω–∫—Ç—É–∞—Ü–∏—è, VAD-–ø–∞—É–∑—ã (350‚Äì450 ms), `speed_jitter`

---

## TTS-–¥–≤–∏–∂–∫–∏ (–æ—Ñ–ª–∞–π–Ω/–æ–Ω–ª–∞–π–Ω)
**–û—Ñ–ª–∞–π–Ω (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):** Silero, Coqui XTTS-v2, Dia, MARS5, Orpheus
**–û–Ω–ª–∞–π–Ω/–≥–∏–±—Ä–∏–¥:** Hume, gTTS, Gemini, OpenAI TTS, Minimax, Chatterbox, VibeVoice
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ: https://huggingface.co/spaces/TTS-AGI/TTS-Arena

> –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã —Å–ø–∏–∫–µ—Ä–æ–≤ –¥–ª—è Coqui XTTS –∫–ª–∞–¥–∏—Ç–µ –≤ `models/speakers/<–∏–º—è>`.

### Silero requirements
Silero TTS requires `torch` and `torchaudio`. Install them to avoid a BeepTTS fallback:
```bash
uv pip install torch torchaudio --index-url https://download.pytorch.org/whl/cu121
```
If these packages are missing, the pipeline falls back to BeepTTS with an audible beep.

### TTS dependencies
Missing Python packages are installed automatically into `.venv` for TTS engines:

- Silero: `torch` and `torchaudio` (`uv pip install torch torchaudio --index-url https://download.pytorch.org/whl/cu121`)
- Coqui XTTS: `TTS`
- gTTS: `gTTS`

–ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, –¥–≤–∏–∂–æ–∫ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è. –ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –µ–≥–æ –ø–æ–∑–¥–Ω–µ–µ,
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç –≤—Ä—É—á–Ω—É—é, –Ω–∞–ø—Ä–∏–º–µ—Ä: `uv pip install TTS`.


- gTTS: –≤—ã–±–µ—Ä–∏—Ç–µ –¥–≤–∏–∂–æ–∫ `gtts` –≤ UI. –°–µ—Ä–≤–∏—Å –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≥–æ–ª–æ—Å–∞ –∏ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.

### TTS CLI
–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `TTS_ENGINE` ‚Äî –¥–≤–∏–∂–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `silero`)
- `SILERO_SPEAKER` ‚Äî –∏–º—è –¥–∏–∫—Ç–æ—Ä–∞

```bash
uv run python -m ui.main --say "text"
# –ø–æ—è–≤–∏—Ç—Å—è output/tts_test.wav
```

---

## –ó–≤—É–∫: –º—É–∑—ã–∫–∞, SFX, –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å
- –§–æ–Ω: ‚àí18 dB, sidechain ducking (–±–µ–∑ `makeup=0`), ¬´–ø–æ–¥–Ω–∏–º–∞—Ç—å –Ω–∞ –ø–∞—É–∑–∞—Ö¬ª
- –ì–æ–ª–æ—Å: –ª—ë–≥–∫–∏–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä, –¥–µ-–∫–ª–∏–∫, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
- SFX: —Ä—É—á–Ω–æ–π —Å–ª–æ–π –∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (ElevenLabs SFX)

---

## –õ—ë–≥–∫–∏–π –≤–∏–¥–µ–æ—Ä–µ–¥–∞–∫—Ç–æ—Ä (—Ç–∞–π–º–ª–∞–π–Ω)
- –û–±—Ä–µ–∑–∫–∞/—Ç—Ä–∏–º/—Å–∫–æ—Ä–æ—Å—Ç—å, –ª–æ–≥–æ—Ç–∏–ø/–∑–∞—Å—Ç–∞–≤–∫–∞
- –î–æ—Ä–æ–∂–∫–∏: Video ‚Ä¢ Voice ‚Ä¢ Music ‚Ä¢ SFX, –∑—É–º —Ç–∞–π–º–ª–∞–π–Ω–∞, –º–∞—Ä–∫–µ—Ä—ã
- –≠–∫—Å–ø–æ—Ä—Ç: H.264/H.265, SRT/–≤–ø–µ—á—ë–Ω–Ω—ã–µ —Å—É–±—Ç–∏—Ç—Ä—ã

---

## Live —Ä–µ–∂–∏–º (—Ä–µ–∞–ª—Ç–∞–π–º –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: https://github.com/Mozer/talk-llama-fast
- STT: whisper.cpp, LLM: Mistral 7B (Q5_0.gguf), TTS: XTTSv2 streaming

---

## ¬´–ë—ã–ª–æ ‚Üí —Å—Ç–∞–ª–æ¬ª –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
- –î–≤–∞ –ø–ª–µ–µ—Ä–∞ (–æ—Ä–∏–≥–∏–Ω–∞–ª/–Ω–æ–≤–∞—è –æ–∑–≤—É—á–∫–∞) + —Ç–∞–±–ª–∏—Ü–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞ (HTML/CSV) —Å–æ —Å–ø–∏—Å–∫–æ–º –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∏ —Ç–∞–π–º–∏–Ω–≥–æ–≤

---

## –ü—Ä–µ—Å–µ—Ç—ã –¥–∏–∫—Ç–æ—Ä–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–∞
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: speed 0.98‚Äì1.02, pause 350‚Äì450 ms, `speed_jitter=0.03‚Äì0.05`
- –°—Ç–∏–ª–∏: –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π, –û–±—ä—è—Å–Ω—è—é—â–∏–π, –†–µ–∫–ª–∞–º–Ω—ã–π, –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π
- –ö–Ω–æ–ø–∫–∞ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–π –ø—Ä–µ—Å–µ—Ç¬ª ‚Üí `.rvpreset`

---

## –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –ø–æ —Å–ø—Ä–∏–Ω—Ç–∞–º
- –°–ø—Ä–∏–Ω—Ç A ‚Äî Qt-MVP (UI, —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å diff, ducking, .rvproj)
- –°–ø—Ä–∏–Ω—Ç B ‚Äî –†–∏—Ç–º/—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (—è–∫–æ—Ä—è, –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å, —ç–∫—Å–ø–æ—Ä—Ç SRT/CSV)
- –°–ø—Ä–∏–Ω—Ç C ‚Äî TTS-–ø—É–ª (Dia/MARS5), –ø—Ä–µ–¥–ø—Ä–æ—Å–ª—É—à–∫–∞
- –°–ø—Ä–∏–Ω—Ç D ‚Äî –¢–∞–π–º–ª–∞–π–Ω (NLE-–ª–∞–π—Ç)
- –°–ø—Ä–∏–Ω—Ç E ‚Äî Live —Ä–µ–∂–∏–º (talk-llama-fast)
- –°–ø—Ä–∏–Ω—Ç F ‚Äî –û–±–ª–∞–∫–æ (Hume, Gemini, OpenAI TTS), SFX-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è

---

## –†–∏—Å–∫–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞
- VRAM/–≤–µ—Å–∞: –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤–∏–¥–µ–æ–ø–∞–º—è—Ç—å, –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –ª—ë–≥–∫–∏–µ –º–æ–¥–µ–ª–∏
- RU –¥–∏–∫—Ü–∏—è: –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å EN/ZH zero-shot –¥–ª—è RU –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –õ–∏—Ü–µ–Ω–∑–∏–∏/–∫–æ–Ω—Ç–µ–Ω—Ç: –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å –ø—Ä–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥–æ–ª–æ—Å–æ–≤
- –õ–æ–≥–∏ –∏ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```bash
uv run ruff check .
uv run ruff format --check .
uv run mypy .
uv run pytest -q
```

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
# 1) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å uv –∏ Python 3.10‚Äì3.12
# 2) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
uv sync --all-extras --frozen
# 3) –ó–∞–ø—É—Å—Ç–∏—Ç—å UI
uv run python -m ui.main
# 4) (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ø–æ–ª–æ–∂–∏—Ç—å ffmpeg –≤ ./bin –∏–ª–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤ PATH
```

## –õ–∏—Ü–µ–Ω–∑–∏—è
MIT
